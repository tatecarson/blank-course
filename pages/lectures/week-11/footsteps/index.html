<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="DAD 422 is an introduction to the theory and practice of spatial audio and immersive sound. These fields will be explored in combination with an introduction to game audio and sound design using the Unity game engine."><title>Adding footsteps</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=../../../../icon.png><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Source+Sans+Pro:wght@400;700&family=Fira+Code:wght@400;700&display=swap" rel=stylesheet><style>:root{--light:#faf8f8;--dark:#141021;--secondary:#284b63;--tertiary:#84a59d;--visited:#afbfc9;--primary:#f28482;--gray:#4e4e4e;--lightgray:#f0f0f0;--outlinegray:#dadada}[saved-theme=dark]{--light:#1e1e21 !important;--dark:#fbfffe !important;--secondary:#5b778a !important;--visited:#4a575e !important;--tertiary:#84a59d !important;--primary:#f58382 !important;--gray:#d4d4d4 !important;--lightgray:#292633 !important;--outlinegray:#343434 !important}</style><style>:root{--lt-colours-light:var(--light) !important;--lt-colours-lightgray:var(--lightgray) !important;--lt-colours-dark:var(--secondary) !important;--lt-colours-secondary:var(--tertiary) !important;--lt-colours-gray:var(--outlinegray) !important}h1,h2,h3,h4,ol,ul,thead{font-family:Inter;color:var(--dark)}p,ul,text{font-family:source sans pro,sans-serif;color:var(--gray);fill:var(--gray)}a{font-family:Inter;font-weight:700;font-size:1em;text-decoration:none;transition:all .2s ease;color:var(--secondary)}a:hover{color:var(--tertiary)!important}#TableOfContents>ol{counter-reset:section;margin-left:0;padding-left:1.5em}#TableOfContents>ol>li{counter-increment:section}#TableOfContents>ol>li>ol{counter-reset:subsection}#TableOfContents>ol>li>ol>li{counter-increment:subsection}#TableOfContents>ol>li>ol>li::marker{content:counter(section)"." counter(subsection)"  "}#TableOfContents>ol>li::marker{content:counter(section)"  "}#TableOfContents>ol>li::marker,#TableOfContents>ol>li>ol>li::marker{font-family:Source Sans Pro;font-weight:700}footer{margin-top:4em;text-align:center}table{width:100%}img{width:100%;border-radius:3px;margin:1em 0}p>img+em{display:block;transform:translateY(-1em)}sup{line-height:0}p,tbody,li{font-family:Source Sans Pro;color:var(--gray);line-height:1.5em}h2{opacity:.85}h3{opacity:.75}blockquote{margin-left:0;border-left:3px solid var(--secondary);padding-left:1em;transition:border-color .2s ease}blockquote:hover{border-color:var(--tertiary)}table{padding:1.5em}td,th{padding:.1em .5em}.footnotes p{margin:.5em 0}article a{font-family:Source Sans Pro;font-weight:600;text-decoration:underline;text-decoration-color:var(--tertiary);text-decoration-thickness:.15em}sup>a{text-decoration:none;padding:0 .1em 0 .2em}pre{font-family:fira code;padding:.75em;border-radius:3px;overflow-x:scroll}code{font-family:fira code;font-size:.85em;padding:.15em .3em;border-radius:5px;background:var(--lightgray)}html{scroll-behavior:smooth}body{margin:0;height:100vh;width:100vw;overflow-x:hidden;background-color:var(--light)}@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}footer{margin-top:4em}footer>a{font-size:1em;color:var(--secondary);padding:0 .5em 3em}hr{width:25%;margin:4em auto;height:2px;border-radius:1px;border-width:0;color:var(--dark);background-color:var(--dark)}a[href^="/"]{text-decoration:none;background-color:#afbfc922;padding:0 .2em;border-radius:3px}.singlePage{margin:4em 30vw}@media all and (max-width:1200px){.singlePage{margin:25px 5vw}}.page-end{display:flex;flex-direction:row}@media all and (max-width:780px){.page-end{flex-direction:column}}.page-end>*{flex:1 0}.page-end>.backlinks-container>ul{list-style:none;padding-left:0;margin-right:2em}.page-end>.backlinks-container>ul>li{margin:.5em 0;padding:.25em 1em;border:var(--outlinegray)1px solid;border-radius:5px}.page-end #graph-container{border:var(--outlinegray)1px solid;border-radius:5px}.centered{margin-top:30vh}</style><style>.darkmode{text-align:right}.darkmode>.toggle{display:none;box-sizing:border-box}.darkmode>.toggle:checked+.toggle-button:after{left:50%}.darkmode>.toggle+.toggle-button{box-sizing:border-box;outline:0;display:inline-block;width:3em;height:1.5em;position:relative;cursor:pointer;border:2px solid var(--gray);user-select:none;padding:2px;transition:all .2s ease;border-radius:2em}.darkmode>.toggle+.toggle-button:after,.darkmode>.toggle+.toggle-button:before{position:relative;display:block;box-sizing:border-box;content:"";width:50%;height:100%}.darkmode>.toggle+.toggle-button:before{display:none}.darkmode>.toggle+.toggle-button:after{left:0;transition:all .2s ease;background:var(--gray);content:"";border-radius:1em}.darkmode #dayIcon{position:relative;width:20px;height:20px;top:-1.5px;margin:0 7px;fill:var(--gray)}.darkmode #nightIcon{position:relative;width:18px;height:18px;top:-2px;margin:0 7px;fill:var(--gray)}</style><style>.chroma{color:#f8f8f2;background-color:#282a36}.chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.chroma .lntable{border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block}.chroma .hl{display:block;width:100%;background-color:#ffc}.chroma .lnt{margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .ln{margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .k{color:#ff79c6}.chroma .kc{color:#ff79c6}.chroma .kd{color:#8be9fd;font-style:italic}.chroma .kn{color:#ff79c6}.chroma .kp{color:#ff79c6}.chroma .kr{color:#ff79c6}.chroma .kt{color:#8be9fd}.chroma .na{color:#50fa7b}.chroma .nb{color:#8be9fd;font-style:italic}.chroma .nc{color:#50fa7b}.chroma .nf{color:#50fa7b}.chroma .nl{color:#8be9fd;font-style:italic}.chroma .nt{color:#ff79c6}.chroma .nv{color:#8be9fd;font-style:italic}.chroma .vc{color:#8be9fd;font-style:italic}.chroma .vg{color:#8be9fd;font-style:italic}.chroma .vi{color:#8be9fd;font-style:italic}.chroma .s{color:#f1fa8c}.chroma .sa{color:#f1fa8c}.chroma .sb{color:#f1fa8c}.chroma .sc{color:#f1fa8c}.chroma .dl{color:#f1fa8c}.chroma .sd{color:#f1fa8c}.chroma .s2{color:#f1fa8c}.chroma .se{color:#f1fa8c}.chroma .sh{color:#f1fa8c}.chroma .si{color:#f1fa8c}.chroma .sx{color:#f1fa8c}.chroma .sr{color:#f1fa8c}.chroma .s1{color:#f1fa8c}.chroma .ss{color:#f1fa8c}.chroma .m{color:#bd93f9}.chroma .mb{color:#bd93f9}.chroma .mf{color:#bd93f9}.chroma .mh{color:#bd93f9}.chroma .mi{color:#bd93f9}.chroma .il{color:#bd93f9}.chroma .mo{color:#bd93f9}.chroma .o{color:#ff79c6}.chroma .ow{color:#ff79c6}.chroma .c{color:#6272a4}.chroma .ch{color:#6272a4}.chroma .cm{color:#6272a4}.chroma .c1{color:#6272a4}.chroma .cs{color:#6272a4}.chroma .cp{color:#ff79c6}.chroma .cpf{color:#ff79c6}.chroma .gd{color:#8b080b}.chroma .ge{text-decoration:underline}.chroma .gh{font-weight:700}.chroma .gi{font-weight:700}.chroma .go{color:#44475a}.chroma .gu{font-weight:700}.chroma .gl{text-decoration:underline}.lntd:first-of-type>.chroma{padding-right:0}.chroma code{font-family:fira code!important;font-size:.85em;line-height:1em;background:0 0;padding:0}.chroma{border-radius:3px;margin:0}</style><script>const userPref=window.matchMedia('(prefers-color-scheme: light)').matches?'light':'dark',currentTheme=localStorage.getItem('theme')??userPref;currentTheme&&document.documentElement.setAttribute('saved-theme',currentTheme);const switchTheme=a=>{a.target.checked?(document.documentElement.setAttribute('saved-theme','dark'),localStorage.setItem('theme','dark')):(document.documentElement.setAttribute('saved-theme','light'),localStorage.setItem('theme','light'))};window.addEventListener('DOMContentLoaded',()=>{const a=document.querySelector('#darkmode-toggle');a.addEventListener('change',switchTheme,!1),currentTheme==='dark'&&(a.checked=!0)})</script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-XYFD95KB4J',{anonymize_ip:!1})}</script><body><div class=singlePage><div class=darkmode><label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label class=toggle-button for=darkmode-toggle></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div><article><h1>Adding footsteps</h1><p>We&rsquo;ll build a footstep system for our environment that has the following properties:</p><ul><li>player is grounded</li><li>match player&rsquo;s speed</li><li>random + no repeats</li><li>material specific</li></ul><p>Our materials in this project are stone, dirt/grass, and wooden floors. We can check if a player is on the terrain and if the player is in a building. If they&rsquo;re inside then they are standing on a wooden floor. Then we can assume that if they player is outside, then they&rsquo;re on stone or on dirt.</p><p>First we need to check if we&rsquo;re grounded. To do that create a new script called <code>CheckIfGrounded</code> and add it to the FpsController. Add the following code:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#><span class=k>public</span> <span class=k>class</span> <span class=nc>CheckIfGrounded</span> <span class=p>:</span> <span class=n>MonoBehaviour</span>
<span class=p>{</span>
    <span class=k>public</span> <span class=n>Collider</span> <span class=n>playerCollider</span><span class=p>;</span>

    <span class=k>public</span> <span class=kt>bool</span> <span class=n>isGrounded</span><span class=p>;</span>
    <span class=k>public</span> <span class=kt>bool</span> <span class=n>isOnTerrain</span><span class=p>;</span>
    <span class=k>public</span> <span class=kt>bool</span> <span class=n>isInside</span><span class=p>;</span>

    <span class=n>RaycastHit</span> <span class=n>hit</span><span class=p>;</span> 

    <span class=c1>// Update is called once per frame
</span><span class=c1></span>    <span class=k>void</span> <span class=n>Update</span><span class=p>()</span>
    <span class=p>{</span>
        
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>We create a variable for our player collider, three for our isGrounded, isOnTerrain, and isInside booleans, and a variable for our raycast hit. We&rsquo;ll use this to check if the player is grounded. To figure this out we fire a raycast down from the collider of the player. We&rsquo;ll use the
<a href=https://docs.unity3d.com/ScriptReference/Physics.Raycast.html rel=noopener><code>Physics.Raycast</code></a>
function. See the parameters that the raycast takes in the link above. We&rsquo;ll add this function to our class:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#> <span class=kt>bool</span> <span class=n>PlayerGrounded</span><span class=p>()</span>
<span class=p>{</span>
    <span class=k>return</span> <span class=n>Physics</span><span class=p>.</span><span class=n>Raycast</span><span class=p>(</span><span class=n>transform</span><span class=p>.</span><span class=n>position</span><span class=p>,</span> <span class=n>Vector3</span><span class=p>.</span><span class=n>down</span><span class=p>,</span> <span class=k>out</span> <span class=n>hit</span><span class=p>,</span> <span class=n>playerCollider</span><span class=p>.</span><span class=n>bounds</span><span class=p>.</span><span class=n>extents</span><span class=p>.</span><span class=n>y</span> <span class=p>+</span> <span class=m>0.5f</span> <span class=p>);</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>Here we assign the position of our player to the starting point of the raycast, then we point the raycast down towards the ground. Hit stores information about the object that the raycast hits. We&rsquo;ll use this to check if the player is grounded. Then we set the maxDistance of the raycast with <code>playerCollider.bounds.extents.y + 0.5f</code>.</p><p>Next add the following function to check if we&rsquo;re on the terrain:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#><span class=kt>bool</span> <span class=n>CheckOnTerrain</span><span class=p>()</span>
<span class=p>{</span>
    <span class=k>return</span> <span class=n>hit</span><span class=p>.</span><span class=n>collider</span> <span class=p>!=</span> <span class=k>null</span> <span class=p>&amp;&amp;</span> <span class=n>hit</span><span class=p>.</span><span class=n>collider</span><span class=p>.</span><span class=n>tag</span> <span class=p>==</span> <span class=s>&#34;Terrain&#34;</span><span class=p>;</span> 
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>We use the hit variable that has raycast data to know if we&rsquo;re on terrain. If the tag of hit is &ldquo;Terrain&rdquo; then we&rsquo;re on the terrain. Otherwise we&rsquo;re not.</p><p>Now we&rsquo;ll check if we&rsquo;re inside using the method from the previous lesson.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#><span class=kt>bool</span> <span class=n>CheckIfInside</span><span class=p>()</span>
<span class=p>{</span>
    <span class=k>return</span> <span class=n>SunTemple</span><span class=p>.</span><span class=n>ExposureManager</span><span class=p>.</span><span class=n>instance</span><span class=p>.</span><span class=n>zoneCounter</span> <span class=p>&gt;</span> <span class=m>0</span><span class=p>;</span> 
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>Now run the functions in the Update function and assign them to your boolean variables:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#><span class=k>void</span> <span class=n>Update</span><span class=p>()</span>
<span class=p>{</span>
    <span class=n>isGrounded</span> <span class=p>=</span> <span class=n>PlayerGrounded</span><span class=p>();</span>
    <span class=n>isOnTerrain</span> <span class=p>=</span> <span class=n>CheckOnTerrain</span><span class=p>();</span>
    <span class=n>isInside</span> <span class=p>=</span> <span class=n>CheckIfInside</span><span class=p>();</span> 
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>Drag the FpsController GameObject onto the PlayerCollider variable. Find the <code>Terrain</code> GameObject and give it a tag of <code>Terrain</code>. You will have to add this tag yourself.</p><h2 id=create-the-checkterraintexture-script-and-variables>Create the CheckTerrainTexture script and variables</h2><p>In Unity Terrain textures are stored as Alpha Maps or “Splat Maps”, which are arrays of values that hold the mix of each different texture at every point on the Terrain. It’s possible to detect what mix of textures the player is standing on at any given moment by converting the player’s current transform position to a coordinate on the alpha map image. This can then be used to check the Alpha Map data at that position. This is ideal for determining what footstep sound should play. In this post I’ll show you how to detect what surface material the player is standing on step by step and how you can use that data to trigger footstep sounds.</p><p>Now that we know we are on terrain, we need to know what specific texture we&rsquo;re standing on when we&rsquo;re on the terrain. To do this we&rsquo;ll create a new script called <code>CheckTerrainTexture</code> and add it to the FpsController. Add the following variables:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#><span class=k>public</span> <span class=n>Transform</span> <span class=n>playerTransform</span><span class=p>;</span>
<span class=k>public</span> <span class=n>Terrain</span> <span class=n>terrainObject</span><span class=p>;</span>

<span class=k>public</span> <span class=kt>int</span> <span class=n>posX</span><span class=p>;</span>
<span class=k>public</span> <span class=kt>int</span> <span class=n>posZ</span><span class=p>;</span>

<span class=k>public</span> <span class=kt>float</span><span class=p>[]</span> <span class=n>textureValues</span><span class=p>;</span> 
</code></pre></td></tr></table></div></div><p>In the start function add the following code:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#><span class=n>terrainObject</span> <span class=p>=</span> <span class=n>Terrain</span><span class=p>.</span><span class=n>activeTerrain</span><span class=p>;</span>
<span class=n>playerTransform</span> <span class=p>=</span> <span class=n>gameObject</span><span class=p>.</span><span class=n>transform</span><span class=p>;</span> 
</code></pre></td></tr></table></div></div><h2 id=convert-the-players-position-to-an-alpha-map-coordinate>Convert the player’s position to an alpha map coordinate</h2><p>Add the following function to covert the player’s position to an alpha map coordinate:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#> <span class=c1>// Translate world position into alphamap position 
</span><span class=c1></span><span class=k>void</span> <span class=n>UpdatePosition</span><span class=p>()</span>
<span class=p>{</span>
    <span class=n>Vector3</span> <span class=n>terrainPosition</span> <span class=p>=</span> <span class=n>playerTransform</span><span class=p>.</span><span class=n>position</span> <span class=p>-</span> <span class=n>terrainObject</span><span class=p>.</span><span class=n>transform</span><span class=p>.</span><span class=n>position</span><span class=p>;</span>
    <span class=n>Vector3</span> <span class=n>mapPosition</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Vector3</span><span class=p>(</span><span class=n>terrainPosition</span><span class=p>.</span><span class=n>x</span> <span class=p>/</span> <span class=n>terrainObject</span><span class=p>.</span><span class=n>terrainData</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>x</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span>
        <span class=n>terrainPosition</span><span class=p>.</span><span class=n>z</span> <span class=p>/</span> <span class=n>terrainObject</span><span class=p>.</span><span class=n>terrainData</span><span class=p>.</span><span class=n>size</span><span class=p>.</span><span class=n>z</span><span class=p>);</span>
    <span class=kt>float</span> <span class=n>xCoord</span> <span class=p>=</span> <span class=n>mapPosition</span><span class=p>.</span><span class=n>x</span> <span class=p>*</span> <span class=n>terrainObject</span><span class=p>.</span><span class=n>terrainData</span><span class=p>.</span><span class=n>alphamapWidth</span><span class=p>;</span>
    <span class=kt>float</span> <span class=n>zCoord</span> <span class=p>=</span> <span class=n>mapPosition</span><span class=p>.</span><span class=n>z</span> <span class=p>*</span> <span class=n>terrainObject</span><span class=p>.</span><span class=n>terrainData</span><span class=p>.</span><span class=n>alphamapHeight</span><span class=p>;</span>

    <span class=n>posX</span> <span class=p>=</span> <span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=n>xCoord</span><span class=p>;</span>
    <span class=n>posZ</span> <span class=p>=</span> <span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=n>zCoord</span><span class=p>;</span> 
<span class=p>}</span>
</code></pre></td></tr></table></div></div><h2 id=retrieve-the-texture-mix-at-that-position>Retrieve the texture mix at that position</h2><p>The following code will retrieve the texture mix at the player’s position. We will use a new type of array, a 3D array. With this we can store 3 values for each index. The 3 dimensions of the alpha map array relate to the x position, z position and the texture that each splat map belongs to.</p><p>Each float value in the array is a texture mix, which is a value between 0 and 1, that corresponds to how much of the texture is applied at that position. I can use this to find out what mix of surfaces the player is standing on.</p><p>We fill this splatMap array using the GetAlphaMaps function. It takes these four parameters:</p><ul><li>x offset</li><li>z offset</li><li>sample size width</li><li>sample size height</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#><span class=k>void</span> <span class=n>CheckTexture</span><span class=p>()</span>
<span class=p>{</span>
    <span class=c1>// create 3d array 
</span><span class=c1></span>    <span class=kt>float</span><span class=p>[,,]</span> <span class=n>splatMap</span> <span class=p>=</span> <span class=n>terrainObject</span><span class=p>.</span><span class=n>terrainData</span><span class=p>.</span><span class=n>GetAlphamaps</span><span class=p>(</span><span class=n>posX</span><span class=p>,</span> <span class=n>posZ</span><span class=p>,</span> <span class=m>1</span><span class=p>,</span> <span class=m>1</span><span class=p>);</span>

    <span class=n>textureValues</span><span class=p>[</span><span class=m>0</span><span class=p>]</span> <span class=p>=</span> <span class=n>splatMap</span><span class=p>[</span><span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>];</span>
    <span class=n>textureValues</span><span class=p>[</span><span class=m>1</span><span class=p>]</span> <span class=p>=</span> <span class=n>splatMap</span><span class=p>[</span><span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>1</span><span class=p>];</span>
    <span class=n>textureValues</span><span class=p>[</span><span class=m>2</span><span class=p>]</span> <span class=p>=</span> <span class=n>splatMap</span><span class=p>[</span><span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>2</span><span class=p>];</span>
    <span class=n>textureValues</span><span class=p>[</span><span class=m>3</span><span class=p>]</span> <span class=p>=</span> <span class=n>splatMap</span><span class=p>[</span><span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=m>3</span><span class=p>];</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>Back in Unity add four elements to the Texture Values array. Here you will be able to see which texture you&rsquo;re standing on.</p><p><img src=../texture-mix.png alt></p><p>Finally, add the following function to run both the UpdatePosition and CheckTexture functions:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#><span class=k>public</span> <span class=k>void</span> <span class=n>GetTerrainTexture</span><span class=p>()</span>
<span class=p>{</span>
    <span class=n>UpdatePosition</span><span class=p>();</span>
    <span class=n>CheckTexture</span><span class=p>();</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>This GetTerrainTexture function will be called in the next script we make, only when the player is walking.</p><h2 id=use-terrain-texture-data-to-trigger-different-footstep-sounds>Use terrain texture data to trigger different footstep sounds</h2><p>What’s great about this method is that, unlike a tag, it doesn’t just return a true or false value. It’s a mix value, between 0 and 1 that can be used for more natural sounding footstep sounds.</p><p>To create natural landscapes, textures on terrain objects are often blended together. There’s often no hard division between one surface and another. You might be standing on 80% stone and 20% sand, or 100% grass, or 50/50 mud and rocks.</p><p>It’s possible to blend footstep sound effects in the same way for a really effective footsteps system.</p><p>We can do it with the following steps</p><ul><li>Get the terrain alpha map values by using the method above.</li><li>If any texture mix value is more than 0, play a footstep sound from an array of clips for that material.</li><li>Trigger it with Play One Shot, not Play (which takes a volume scale parameter).</li><li>Pass in the texture mix value for the Volume Scale parameter of Play One Shot to blend the sound with any others that are playing.</li></ul><p>This will smoothly blend the footstep clips together depending on what the player’s standing on. Because it uses a volume scale, you will still be able to adjust the total volume of all the footsteps on the Audio Source if you need to.</p><p>Add an AudioSource to the FpsController. Uncheck play on awake and leave it as a 2d sound. Create a new script called footsteps and add it to the FpsController. Add the following variables:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#> <span class=k>public</span> <span class=n>CheckIfGrounded</span> <span class=n>checkIfGrounded</span><span class=p>;</span>
<span class=k>public</span> <span class=n>CheckTerrainTexture</span> <span class=n>checkTerrainTexture</span><span class=p>;</span>

<span class=k>public</span> <span class=n>AudioSource</span> <span class=n>audioSource</span><span class=p>;</span>

<span class=k>public</span> <span class=n>AudioClip</span><span class=p>[]</span> <span class=n>stoneClips</span><span class=p>;</span>
<span class=k>public</span> <span class=n>AudioClip</span><span class=p>[]</span> <span class=n>dirtClips</span><span class=p>;</span>
<span class=k>public</span> <span class=n>AudioClip</span><span class=p>[]</span> <span class=n>woodClips</span><span class=p>;</span>
<span class=k>public</span> <span class=n>AudioClip</span><span class=p>[]</span> <span class=n>sandClips</span><span class=p>;</span> 


<span class=n>AudioClip</span> <span class=n>previousClip</span><span class=p>;</span>

<span class=n>CharacterController</span> <span class=n>character</span><span class=p>;</span>
<span class=kt>float</span> <span class=n>currentSpeed</span><span class=p>;</span>
<span class=kt>bool</span> <span class=n>walking</span><span class=p>;</span>
<span class=kt>float</span> <span class=n>distanceCovered</span><span class=p>;</span>
<span class=k>public</span> <span class=kt>float</span> <span class=n>modifier</span> <span class=p>=</span> <span class=m>0.5f</span><span class=p>;</span>

<span class=kt>float</span> <span class=n>airTime</span><span class=p>;</span> 
</code></pre></td></tr></table></div></div><p>In the start function select the character controller and assign it to the character variable.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#><span class=n>character</span> <span class=p>=</span> <span class=n>gameObject</span><span class=p>.</span><span class=n>GetComponent</span><span class=p>&lt;</span><span class=n>CharacterController</span><span class=p>&gt;();</span> 
</code></pre></td></tr></table></div></div><p>We&rsquo;ll now create functions to check the players speed and if they are walking. We get the magnitude of the velocity of the player, which is the speed. We also check if the player is walking by checking if the player is grounded and if the speed is greater than 0.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#><span class=kt>float</span> <span class=n>GetPlayerSpeed</span><span class=p>()</span>
<span class=p>{</span>
    <span class=kt>float</span> <span class=n>speed</span> <span class=p>=</span> <span class=n>character</span><span class=p>.</span><span class=n>velocity</span><span class=p>.</span><span class=n>magnitude</span><span class=p>;</span>
    <span class=k>return</span> <span class=n>speed</span><span class=p>;</span> 
<span class=p>}</span>

<span class=kt>bool</span> <span class=n>CheckIfWalking</span><span class=p>()</span>
<span class=p>{</span>
    <span class=k>return</span> <span class=n>currentSpeed</span> <span class=p>&gt;</span> <span class=m>0</span> <span class=p>&amp;&amp;</span> <span class=n>checkIfGrounded</span><span class=p>.</span><span class=n>isGrounded</span><span class=p>;</span>
    
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>Now add both of those functions to the update function so they are constantly checked.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#><span class=k>void</span> <span class=n>Update</span><span class=p>()</span>
<span class=p>{</span>
    <span class=n>currentSpeed</span> <span class=p>=</span> <span class=n>GetPlayerSpeed</span><span class=p>();</span>
    <span class=n>walking</span> <span class=p>=</span> <span class=n>CheckIfWalking</span><span class=p>();</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>Next we&rsquo;ll make a function that selects a random clip from an array of clips. This function takes a clip array. First a random clip is picked. Then we check 3 times if that clip is the same as the last clip that was picked. If it is, we pick another clip. If it isn&rsquo;t, we return the clip.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#><span class=n>AudioClip</span> <span class=n>GetClipFromArray</span><span class=p>(</span><span class=n>AudioClip</span><span class=p>[]</span> <span class=n>clipArray</span><span class=p>)</span>
<span class=p>{</span>
    <span class=kt>int</span> <span class=n>attempts</span> <span class=p>=</span> <span class=m>3</span><span class=p>;</span>
    <span class=n>AudioClip</span> <span class=n>selectedClip</span> <span class=p>=</span> <span class=n>clipArray</span><span class=p>[</span><span class=n>Random</span><span class=p>.</span><span class=n>Range</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=n>clipArray</span><span class=p>.</span><span class=n>Length</span><span class=p>)];</span>

    <span class=k>while</span> <span class=p>(</span><span class=n>selectedClip</span> <span class=p>==</span> <span class=n>previousClip</span> <span class=p>&amp;&amp;</span> <span class=n>attempts</span> <span class=p>&gt;</span> <span class=m>0</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=n>selectedClip</span> <span class=p>=</span> <span class=n>clipArray</span><span class=p>[</span><span class=n>Random</span><span class=p>.</span><span class=n>Range</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=n>clipArray</span><span class=p>.</span><span class=n>Length</span><span class=p>)];</span>
        <span class=n>attempts</span><span class=p>--;</span> 
    <span class=p>}</span>

    <span class=n>previousClip</span> <span class=p>=</span> <span class=n>selectedClip</span><span class=p>;</span>

    <span class=k>return</span> <span class=n>selectedClip</span><span class=p>;</span> 

<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>Create a new function to play footstep sounds. We set the pitch and volume of our source to random values. Then we check if the player is on the terrain. Then we update the texture values by running <code>checkTerrainTexture.GetTerrainTexture();</code>. Next we have a series of if statements that check for each terrain value. If the texture value is greater than 0, we play a random clip from the array of clips for that texture. The second parameter of Play One Shot is the volume scale. We use the texture mix value so that the if we&rsquo;re on more than one texture at once, the clips will blend together and not sound too loud. Finally, if we&rsquo;re not on the terrain we check if the player is inside. If the player is neither on the the terrain or inside, then we play the stone footsteps.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#><span class=k>void</span> <span class=n>TriggerNextClip</span><span class=p>()</span>
<span class=p>{</span>
    <span class=n>audioSource</span><span class=p>.</span><span class=n>pitch</span> <span class=p>=</span> <span class=n>Random</span><span class=p>.</span><span class=n>Range</span><span class=p>(</span><span class=m>0.9f</span><span class=p>,</span> <span class=m>1.2f</span><span class=p>);</span>
    <span class=n>audioSource</span><span class=p>.</span><span class=n>volume</span> <span class=p>=</span> <span class=n>Random</span><span class=p>.</span><span class=n>Range</span><span class=p>(</span><span class=m>0.8f</span><span class=p>,</span> <span class=m>1.0f</span><span class=p>);</span>

    <span class=k>if</span> <span class=p>(</span><span class=n>checkIfGrounded</span><span class=p>.</span><span class=n>isOnTerrain</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=n>checkTerrainTexture</span><span class=p>.</span><span class=n>GetTerrainTexture</span><span class=p>();</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>checkTerrainTexture</span><span class=p>.</span><span class=n>textureValues</span><span class=p>[</span><span class=m>0</span><span class=p>]</span> <span class=p>&gt;</span> <span class=m>0</span><span class=p>)</span>
        <span class=p>{</span>
            <span class=n>audioSource</span><span class=p>.</span><span class=n>PlayOneShot</span><span class=p>(</span><span class=n>GetClipFromArray</span><span class=p>(</span><span class=n>stoneClips</span><span class=p>),</span> <span class=n>checkTerrainTexture</span><span class=p>.</span><span class=n>textureValues</span><span class=p>[</span><span class=m>0</span><span class=p>]);</span>
        <span class=p>}</span>


        <span class=k>if</span> <span class=p>(</span><span class=n>checkTerrainTexture</span><span class=p>.</span><span class=n>textureValues</span><span class=p>[</span><span class=m>1</span><span class=p>]</span> <span class=p>&gt;</span> <span class=m>0</span><span class=p>)</span>
        <span class=p>{</span>
            <span class=n>audioSource</span><span class=p>.</span><span class=n>PlayOneShot</span><span class=p>(</span><span class=n>GetClipFromArray</span><span class=p>(</span><span class=n>dirtClips</span><span class=p>),</span> <span class=n>checkTerrainTexture</span><span class=p>.</span><span class=n>textureValues</span><span class=p>[</span><span class=m>1</span><span class=p>]);</span>
        <span class=p>}</span>


        <span class=k>if</span> <span class=p>(</span><span class=n>checkTerrainTexture</span><span class=p>.</span><span class=n>textureValues</span><span class=p>[</span><span class=m>2</span><span class=p>]</span> <span class=p>&gt;</span> <span class=m>0</span><span class=p>)</span>
        <span class=p>{</span>
            <span class=n>audioSource</span><span class=p>.</span><span class=n>PlayOneShot</span><span class=p>(</span><span class=n>GetClipFromArray</span><span class=p>(</span><span class=n>dirtClips</span><span class=p>),</span> <span class=n>checkTerrainTexture</span><span class=p>.</span><span class=n>textureValues</span><span class=p>[</span><span class=m>2</span><span class=p>]);</span>
        <span class=p>}</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>checkTerrainTexture</span><span class=p>.</span><span class=n>textureValues</span><span class=p>[</span><span class=m>3</span><span class=p>]</span> <span class=p>&gt;</span> <span class=m>0</span><span class=p>)</span>
        <span class=p>{</span>
            <span class=n>audioSource</span><span class=p>.</span><span class=n>PlayOneShot</span><span class=p>(</span><span class=n>GetClipFromArray</span><span class=p>(</span><span class=n>sandClips</span><span class=p>),</span> <span class=n>checkTerrainTexture</span><span class=p>.</span><span class=n>textureValues</span><span class=p>[</span><span class=m>3</span><span class=p>]);</span>
        <span class=p>}</span>
    <span class=p>}</span>   <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>checkIfGrounded</span><span class=p>.</span><span class=n>isInside</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=n>audioSource</span><span class=p>.</span><span class=n>PlayOneShot</span><span class=p>(</span><span class=n>GetClipFromArray</span><span class=p>(</span><span class=n>woodClips</span><span class=p>),</span> <span class=m>1</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=k>else</span>
    <span class=p>{</span>
        <span class=n>audioSource</span><span class=p>.</span><span class=n>PlayOneShot</span><span class=p>(</span><span class=n>GetClipFromArray</span><span class=p>(</span><span class=n>stoneClips</span><span class=p>),</span> <span class=m>1</span><span class=p>);</span>
    <span class=p>}</span>
   
    
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>Create a function to handle if the player is falling. If the player is not grounded increase the airTime as the player is falling. If the player has been falling for more than 0.25 seconds trigger the next clip once the player is grounded and reset the airTime.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#><span class=k>void</span> <span class=n>PlaySoundIfFalling</span><span class=p>()</span>
<span class=p>{</span>
    <span class=k>if</span><span class=p>(!</span><span class=n>checkIfGrounded</span><span class=p>.</span><span class=n>isGrounded</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=n>airTime</span> <span class=p>+=</span> <span class=n>Time</span><span class=p>.</span><span class=n>deltaTime</span><span class=p>;</span> 
    <span class=p>}</span> <span class=k>else</span>
    <span class=p>{</span>
        <span class=k>if</span><span class=p>(</span><span class=n>airTime</span> <span class=p>&gt;</span> <span class=m>0.25f</span><span class=p>)</span>
        <span class=p>{</span>
            <span class=n>TriggerNextClip</span><span class=p>();</span>
            <span class=n>airTime</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span> 
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>Add the following code to the update function. Check if the player is falling. If the player is walking only play a sound if the distance covered by the player is greater than 1 then reset the distance covered counter.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-c# data-lang=c#><span class=n>PlaySoundIfFalling</span><span class=p>();</span>

<span class=k>if</span><span class=p>(</span><span class=n>walking</span><span class=p>)</span>
<span class=p>{</span>
    <span class=n>distanceCovered</span> <span class=p>+=</span> <span class=p>(</span><span class=n>currentSpeed</span> <span class=p>*</span> <span class=n>Time</span><span class=p>.</span><span class=n>deltaTime</span><span class=p>)</span> <span class=p>*</span> <span class=n>modifier</span><span class=p>;</span>

    <span class=k>if</span><span class=p>(</span><span class=n>distanceCovered</span> <span class=p>&gt;</span> <span class=m>1</span><span class=p>)</span>
    <span class=p>{</span>
        <span class=n>TriggerNextClip</span><span class=p>();</span>
        <span class=n>distanceCovered</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span> 
    <span class=p>}</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div><p>Finally, go back to the FpsController GameObject and setup the footsteps script as follows:</p><p><img src=../footsteps-script.png alt></p><p>Find the free footsteps asset from the Unity Asset store and drag your clips into the clips array.</p><h2 id=mixer-setup>Mixer setup</h2><p>Create a new mixer called PlayerMixer. Create a group called footsteps. Drag the PlayerMixer mixer into the AudioMixer then select the footsteps group. Now go to your footsteps audio source and set the output to the footsteps group.</p><p>You should now hear different footsteps and be able to mix the levels in relation to all other sounds in the scene.</p></article><hr><div class=page-end><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=../../../../pages/schedule>/pages/schedule</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script>const index={backlinks:{"/pages/database":[{source:"/",target:"/pages/database",text:"game sound database"}],"/pages/lectures/week-1/game-audio-history/":[{source:"/pages/schedule",target:"/pages/lectures/week-1/game-audio-history/",text:"slides"}],"/pages/lectures/week-1/monday-8-23/immersive-spatial":[{source:"/pages/schedule",target:"/pages/lectures/week-1/monday-8-23/immersive-spatial",text:"Immersive and Spatial audio"}],"/pages/lectures/week-10/final-mix":[{source:"/pages/schedule",target:"/pages/lectures/week-10/final-mix",text:"Final mix"}],"/pages/lectures/week-10/third-person-locomotion":[{source:"/pages/schedule",target:"/pages/lectures/week-10/third-person-locomotion",text:"Third Person Player footsteps and emotes"}],"/pages/lectures/week-10/ui-sounds":[{source:"/pages/schedule",target:"/pages/lectures/week-10/ui-sounds",text:"UI sounds"}],"/pages/lectures/week-11/footsteps":[{source:"/pages/schedule",target:"/pages/lectures/week-11/footsteps",text:"Footsteps"}],"/pages/lectures/week-11/sun-temple-ambient-sfx":[{source:"/pages/schedule",target:"/pages/lectures/week-11/sun-temple-ambient-sfx",text:"Ambient sounds"}],"/pages/lectures/week-11/sun-temple-fire-sfx":[{source:"/pages/schedule",target:"/pages/lectures/week-11/sun-temple-fire-sfx",text:"Fire sounds"}],"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/friday-9-3/":[{source:"/pages/schedule",target:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/friday-9-3/",text:"Challenges of game audio"}],"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30":[{source:"/pages/schedule",target:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30",text:"Inform, Entertain, Immerse"}],"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/wednesday-9-1":[{source:"/pages/schedule",target:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/wednesday-9-1",text:"Entertain and immerse"}],"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/wednesday-9-1/intro-to-unity":[{source:"/pages/schedule",target:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/wednesday-9-1/intro-to-unity",text:"more unity intro and practice"}],"/pages/lectures/week-5/sound-design":[{source:"/pages/schedule",target:"/pages/lectures/week-5/sound-design",text:"The art of sound design"}],"/pages/lectures/week-6/practical-sound-design":[{source:"/pages/schedule",target:"/pages/lectures/week-6/practical-sound-design",text:"Practical sound design and prototyping"}],"/pages/lectures/week-8/coding-audio":[{source:"/pages/schedule",target:"/pages/lectures/week-8/coding-audio",text:"coding audio in Unity"}],"/pages/lectures/week-9/animations":[{source:"/pages/schedule",target:"/pages/lectures/week-9/animations",text:"animations to the project"}],"/pages/lectures/week-9/locomotion":[{source:"/pages/schedule",target:"/pages/lectures/week-9/locomotion",text:"Player locomotion"}],"/pages/projects":[{source:"/",target:"/pages/projects",text:"projects"},{source:"/pages/schedule",target:"/pages/projects",text:"**Final project**"},{source:"/pages/schedule",target:"/pages/projects",text:"Project 2 Due 9/17"},{source:"/pages/schedule",target:"/pages/projects",text:"Project 3 – Due 10/1"}],"/pages/resources":[{source:"/",target:"/pages/resources",text:"resources"},{source:"/pages/schedule",target:"/pages/resources",text:"Resources"}],"/pages/schedule":[{source:"/",target:"/pages/schedule",text:"schedule"}],"/pages/syllabus":[{source:"/",target:"/pages/syllabus",text:"syllabus"},{source:"/pages/schedule",target:"/pages/syllabus",text:"Syllabus"}],"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=10":[{source:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/",target:"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=10",text:"Page 11"}],"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=6":[{source:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/",target:"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=6",text:"Page 7"}],"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=7":[{source:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/",target:"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=7",text:"Page 8"}],"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=8":[{source:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/",target:"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=8",text:"Page 9"}],"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=9":[{source:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/",target:"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=9",text:"Page 10"}]},links:{"/":[{source:"/",target:"/pages/syllabus",text:"syllabus"},{source:"/",target:"/pages/schedule",text:"schedule"},{source:"/",target:"/pages/projects",text:"projects"},{source:"/",target:"/pages/database",text:"game sound database"},{source:"/",target:"/pages/resources",text:"resources"}],"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/":[{source:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/",target:"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=7",text:"Page 8"},{source:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/",target:"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=8",text:"Page 9"},{source:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/",target:"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=9",text:"Page 10"},{source:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/",target:"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=10",text:"Page 11"},{source:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/",target:"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=6",text:"Page 7"}],"/pages/schedule":[{source:"/pages/schedule",target:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30",text:"Inform, Entertain, Immerse"},{source:"/pages/schedule",target:"/pages/lectures/week-11/sun-temple-fire-sfx",text:"Fire sounds"},{source:"/pages/schedule",target:"/pages/projects",text:"**Final project**"},{source:"/pages/schedule",target:"/pages/resources",text:"Resources"},{source:"/pages/schedule",target:"/pages/projects",text:"Project 2 Due 9/17"},{source:"/pages/schedule",target:"/pages/lectures/week-10/final-mix",text:"Final mix"},{source:"/pages/schedule",target:"/pages/lectures/week-10/ui-sounds",text:"UI sounds"},{source:"/pages/schedule",target:"/pages/lectures/week-11/footsteps",text:"Footsteps"},{source:"/pages/schedule",target:"/pages/lectures/week-5/sound-design",text:"The art of sound design"},{source:"/pages/schedule",target:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/wednesday-9-1",text:"Entertain and immerse"},{source:"/pages/schedule",target:"/pages/lectures/week-11/sun-temple-ambient-sfx",text:"Ambient sounds"},{source:"/pages/schedule",target:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/wednesday-9-1/intro-to-unity",text:"more unity intro and practice"},{source:"/pages/schedule",target:"/pages/lectures/week-8/coding-audio",text:"coding audio in Unity"},{source:"/pages/schedule",target:"/pages/lectures/week-10/third-person-locomotion",text:"Third Person Player footsteps and emotes"},{source:"/pages/schedule",target:"/pages/lectures/week-1/monday-8-23/immersive-spatial",text:"Immersive and Spatial audio"},{source:"/pages/schedule",target:"/pages/lectures/week-9/locomotion",text:"Player locomotion"},{source:"/pages/schedule",target:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/friday-9-3/",text:"Challenges of game audio"},{source:"/pages/schedule",target:"/pages/syllabus",text:"Syllabus"},{source:"/pages/schedule",target:"/pages/lectures/week-1/game-audio-history/",text:"slides"},{source:"/pages/schedule",target:"/pages/projects",text:"Project 3 – Due 10/1"},{source:"/pages/schedule",target:"/pages/lectures/week-6/practical-sound-design",text:"Practical sound design and prototyping"},{source:"/pages/schedule",target:"/pages/lectures/week-9/animations",text:"animations to the project"}]}},links=[{source:"/",target:"/pages/syllabus",text:"syllabus"},{source:"/",target:"/pages/schedule",text:"schedule"},{source:"/",target:"/pages/projects",text:"projects"},{source:"/",target:"/pages/database",text:"game sound database"},{source:"/",target:"/pages/resources",text:"resources"},{source:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/",target:"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=7",text:"Page 8"},{source:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/",target:"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=8",text:"Page 9"},{source:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/",target:"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=9",text:"Page 10"},{source:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/",target:"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=10",text:"Page 11"},{source:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30/",target:"/x-devonthink-item://86F0CBA7-8C3B-44A8-BE5D-1E39FAB35BF9?page=6",text:"Page 7"},{source:"/pages/schedule",target:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/monday-8-30",text:"Inform, Entertain, Immerse"},{source:"/pages/schedule",target:"/pages/lectures/week-11/sun-temple-fire-sfx",text:"Fire sounds"},{source:"/pages/schedule",target:"/pages/projects",text:"**Final project**"},{source:"/pages/schedule",target:"/pages/resources",text:"Resources"},{source:"/pages/schedule",target:"/pages/projects",text:"Project 2 Due 9/17"},{source:"/pages/schedule",target:"/pages/lectures/week-10/final-mix",text:"Final mix"},{source:"/pages/schedule",target:"/pages/lectures/week-10/ui-sounds",text:"UI sounds"},{source:"/pages/schedule",target:"/pages/lectures/week-11/footsteps",text:"Footsteps"},{source:"/pages/schedule",target:"/pages/lectures/week-5/sound-design",text:"The art of sound design"},{source:"/pages/schedule",target:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/wednesday-9-1",text:"Entertain and immerse"},{source:"/pages/schedule",target:"/pages/lectures/week-11/sun-temple-ambient-sfx",text:"Ambient sounds"},{source:"/pages/schedule",target:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/wednesday-9-1/intro-to-unity",text:"more unity intro and practice"},{source:"/pages/schedule",target:"/pages/lectures/week-8/coding-audio",text:"coding audio in Unity"},{source:"/pages/schedule",target:"/pages/lectures/week-10/third-person-locomotion",text:"Third Person Player footsteps and emotes"},{source:"/pages/schedule",target:"/pages/lectures/week-1/monday-8-23/immersive-spatial",text:"Immersive and Spatial audio"},{source:"/pages/schedule",target:"/pages/lectures/week-9/locomotion",text:"Player locomotion"},{source:"/pages/schedule",target:"/pages/lectures/week-2-the-roll-of-audio-in-interactive-and-immersive-environments/friday-9-3/",text:"Challenges of game audio"},{source:"/pages/schedule",target:"/pages/syllabus",text:"Syllabus"},{source:"/pages/schedule",target:"/pages/lectures/week-1/game-audio-history/",text:"slides"},{source:"/pages/schedule",target:"/pages/projects",text:"Project 3 – Due 10/1"},{source:"/pages/schedule",target:"/pages/lectures/week-6/practical-sound-design",text:"Practical sound design and prototyping"},{source:"/pages/schedule",target:"/pages/lectures/week-9/animations",text:"animations to the project"}],curPage="/pages/lectures/week-11/footsteps",pathColors=[{"/moc":"#4388cc"}],parseIdsFromLinks=a=>[...new Set(a.flatMap(a=>[a.source,a.target]))],data={nodes:parseIdsFromLinks(links).map(a=>({id:a})),links},color=a=>{if(a.id===curPage||a.id==="/"&&curPage==="")return"var(--g-node-active)";for(const b of pathColors){const c=Object.keys(b)[0],d=b[c];if(a.id.startsWith(c))return d}return"var(--g-node)"},drag=c=>{function d(b,a){b.active||c.alphaTarget(1).restart(),a.fx=a.x,a.fy=a.y}function e(a,b){b.fx=a.x,b.fy=a.y}function f(b,a){b.active||c.alphaTarget(0),a.fx=null,a.fy=null}const a=!0,b=()=>{};return d3.drag().on("start",a?d:b).on("drag",a?e:b).on("end",a?f:b)},height=250,width=document.getElementById("graph-container").offsetWidth,simulation=d3.forceSimulation(data.nodes).force("charge",d3.forceManyBody().strength(-20)).force("link",d3.forceLink(data.links).id(a=>a.id)).force("center",d3.forceCenter()),svg=d3.select('#graph-container').append('svg').attr('width',width).attr('height',height).attr("viewBox",[-width/2,-height/2,width,height]),enableLegend=!1;if(enableLegend){const a=[{Current:"var(--g-node-active)"},{Note:"var(--g-node)"},...pathColors];a.forEach((a,b)=>{const c=Object.keys(a)[0],d=a[c];svg.append("circle").attr("cx",-width/2+20).attr("cy",height/2-30*(b+1)).attr("r",6).style("fill",d),svg.append("text").attr("x",-width/2+40).attr("y",height/2-30*(b+1)).text(c).style("font-size","15px").attr("alignment-baseline","middle")})}const link=svg.append("g").selectAll("line").data(data.links).join("line").attr("class","link").attr("stroke","var(--g-link)").attr("stroke-width",2).attr("data-source",a=>a.source.id).attr("data-target",a=>a.target.id),graphNode=svg.append("g").selectAll("g").data(data.nodes).enter().append("g"),node=graphNode.append("circle").attr("class","node").attr("id",a=>a.id).attr("r",a=>{const b=index.links[a.id]?.length||0,c=index.backlinks[a.id]?.length||0;return 3+(b+c)/4}).attr("fill",color).style("cursor","pointer").on("click",(b,a)=>{window.location.href="/"+a.id}).on("mouseover",function(f,a){d3.selectAll(".node").transition().duration(100).attr("fill","var(--g-node-inactive)");const c=parseIdsFromLinks([...index.links[a.id]||[],...index.backlinks[a.id]||[]]),d=d3.selectAll(".node").filter(a=>c.includes(a.id)),b=a.id,e=d3.selectAll(".link").filter(a=>a.source.id===b||a.target.id===b);d.transition().duration(200).attr("fill",color),e.transition().duration(200).attr("stroke","var(--g-link-active)"),d3.select(this.parentNode).select("text").raise().transition().duration(200).style("opacity",1)}).on("mouseleave",function(d,b){d3.selectAll(".node").transition().duration(200).attr("fill",color);const a=b.id,c=d3.selectAll(".link").filter(b=>b.source.id===a||b.target.id===a);c.transition().duration(200).attr("stroke","var(--g-link)"),d3.select(this.parentNode).select("text").transition().duration(200).style("opacity",0)}).call(drag(simulation)),labels=graphNode.append("text").attr("dx",12).attr("dy",".35em").text(a=>a.id).style("opacity",0).style("pointer-events","none").call(drag(simulation)),enableZoom=!0;enableZoom&&svg.call(d3.zoom().extent([[0,0],[width,height]]).scaleExtent([.25,4]).on("zoom",({transform:a})=>{link.attr("transform",a),node.attr("transform",a),labels.attr("transform",a)})),simulation.on("tick",()=>{link.attr("x1",a=>a.source.x).attr("y1",a=>a.source.y).attr("x2",a=>a.target.x).attr("y2",a=>a.target.y),node.attr("cx",a=>a.x).attr("cy",a=>a.y),labels.attr("x",a=>a.x).attr("y",a=>a.y)})</script></div></div><div id=contact_buttons><footer><p>Made by Tate Carson using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2022</p><a href=../../../../>Home</a></footer></div></div></body></html>